'use strict';
module.exports = function(KEY, length, exec){
  var defined  = require('./$.defined.js')
    , SYMBOL   = require('./$.wks.js')(KEY)
    , original = ''[KEY];
  if(require('./$.fails.js')(function(){
    var O = {};
    O[SYMBOL] = function(){ return 7; };
    return ''[KEY](O) != 7;
  })){
    require('./$.redef.js')(String.prototype, KEY, exec(defined, SYMBOL, original));
    require('./$.hide.js')(RegExp.prototype, SYMBOL, length == 2
      // 21.2.5.8 RegExp.prototype[@@replace](string, replaceValue)
      // 21.2.5.11 RegExp.prototype[@@split](string, limit)
      ? function(string, arg){ return original.call(string, this, arg); }
      // 21.2.5.6 RegExp.prototype[@@match](string)
      // 21.2.5.9 RegExp.prototype[@@search](string)
      : function(string){ return original.call(string, this); }
    );
  }
};